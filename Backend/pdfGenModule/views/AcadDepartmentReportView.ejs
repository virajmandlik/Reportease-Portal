<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Academic Report for Year: <%= year %></title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --text-color: #333;
            --background-color: #f4f6f7;
            --table-header-bg: #2c3e50;
            --table-alternate-row: #f2f2f2;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--background-color);
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 20px;
            background-color: white;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .generated-info {
            position: fixed;
            top: 20px;
            right: 20px;
            font-size: 12px;
            color: #555;
            z-index: 1000;
        }

        h1 {
            text-align: center;
            color: var(--primary-color);
            margin-bottom: 20px;
        }

        h2, h3, h4 {
            text-align: center;
            color: var(--secondary-color);
            margin-bottom: 10px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 2px 3px rgba(0,0,0,0.1);
        }

        table th {
            background-color: var(--table-header-bg);
            color: white;
            padding: 12px;
            text-align: left;
        }

        table td {
            padding: 10px;
            border: 1px solid #ddd;
        }

        table tr:nth-child(even) {
            background-color: var(--table-alternate-row);
        }

        table tr:hover {
            background-color: #e6e6e6;
            transition: background-color 0.3s ease;
        }

        .footer {
            text-align: center;
            padding: 15px;
            background-color: var(--primary-color);
            color: white;
            margin-top: 20px;
        }

        @media print {
            .generated-info {
                position: absolute;
            }
            body {
                background-color: white;
            }
        }
    </style>
</head>
<body>
    <div class="generated-info">
        Generated on: <%= new Date().toLocaleString() %>
    </div>
    <div class="container">
        <h1>Academic Report for Year: <%= year %></h1>
        <h2>Prepared by: <%= user.first_name %> <%= user.last_name %></h2>
        <h3> Department: Academic Department</h3>
        <h4>Institute: <%= instituteName %></h4>

        <h4>Student Data</h4>
        <table>
            <thead>
                <tr>
                    <th>Student ID</th>
                    <th>User ID</th>
                    <th>Program ID</th>
                    <th>Current Semester</th>
                    <th>Registration Number</th>
                    <th>Year</th>
                </tr>
            </thead>
            <tbody>
                <% if (studentData.length > 0) { %>
                    <% studentData.forEach(student => { %>
                        <tr>
                            <td><%= student.student_id %></td>
                            <td><%= student.user_id %></td>
                            <td><%= student.program_id %></td>
                            <td><%= student.current_semester || 'N/A' %></td>
                            <td><%= student.stud_reg || 'N/A' %></td>
                            <td><%= student.year || 'N/A' %></td>
                        </tr>
                    <% }); %>
                <% } else { %>
                    <tr>
                        <td colspan="6" style="text-align: center;">No student data available for the selected year.</td>
                    </tr>
                <% } %>
            </tbody>
        </table>

        <h4>Faculty Data</h4>
        <table>
            <thead>
                <tr>
                    <th>Faculty ID</th>
                    <th>User ID</th>
                    <th>Registration Number</th>
                    <th>Department ID</th>
                    <th>Year</th>
                </tr>
            </thead>
            <tbody>
                <% if (facultyData.length > 0) { %>
                    <% facultyData.forEach(faculty => { %>
                        <tr>
                            <td><%= faculty.faculty_id %></td>
                            <td><%= faculty.user_id %></td>
                            <td><%= faculty.reg_no || 'N/A' %></td>
                            <td><%= faculty.dept_id %></td>
                            <td><%= faculty.year || 'N/A' %></td>
                        </tr>
                    <% }); %>
                <% } else { %>
                    <tr>
                        <td colspan="5" style="text-align: center;">No faculty data available for the selected year.</td>
                    </tr>
                <% } %>
            </tbody>
        </table>

        <h4>Program Data</h4>
        <table>
            <thead>
                <tr>
                    <th>Program ID</th>
                    <th>Program Name</th>
                    <th>Department ID</th>
                    <th>Duration</th>
                    <th>Intake</th>
                    <th>Semester Count</th>
                    <th>Year</th>
                </tr>
            </thead>
            <tbody>
                <% if (programData.length > 0) { %>
                    <% programData.forEach(program => { %>
                        <tr>
                            <td><%= program.prog_id %></td>
                            <td><%= program.prog_name %></td>
                            <td><%= program.dept_id %></td>
                            <td><%= program.duration %></td>
                            <td><%= program.intake || 'N/A' %></td>
                            <td><%= program.semester_count %></td>
                            <td><%= program.year || 'N/A' %></td>
                        </tr>
                    <% }); %>
                <% } else { %>
                    <tr>
                        <td colspan="7" style="text-align: center;">No program data available for the selected year.</td>
                    </tr>
                <% } %>
            </tbody>
        </table>

        <h4>Result Data</h4>
        <table>
            <thead>
                <tr>
                    <th>Result ID</th>
                    <th>Enrollment ID</th>
                    <th>Grade</th>
                    <th>Status</th>
                    <th>Year</th>
                </tr>
            </thead>
            <tbody>
                <% if (resultData.length > 0) { %>
                    <% resultData.forEach(result => { %>
                        <tr>
                            <td><%= result.result_id %></td>
                            <td><%= result.enrollment_id %></td>
                            <td><%= result.grade || 'N/A' %></td>
                            <td><%= result.res_status || 'N/A' %></td>
                            <td><%= result.year || 'N/A' %></td>
                        </tr>
                    <% }); %>
                <% } else { %>
                    <tr>
                        <td colspan="5" style="text-align: center;">No result data available for the selected year.</td>
                    </tr>
                <% } %>
            </tbody>
        </table>

        <div class="footer">
            Â© <%= new Date().getFullYear() %> <%= instituteName %>. All Rights Reserved.
        </div>
    </div>
</body>
</html>